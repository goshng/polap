
+ test 1 -eq 1
+ step0
+ echo 'DEBUG: start of step0'
+ [[ ! -e o ]]
+ echo 'INFO: o:' an output folder is created.
+ mkdir -p o
+ command -v seqkit
+ command -v minimap2
+ command -v flye
+ command -v makeblastdb
+ command -v tblastn
+ command -v bedtools
+ command -v prefetch
+ command -v jellyfish
+ [[ -n '' ]]
+ [[ -n '' ]]
+ [[ -s n3k.fq.gz ]]
+ [[ -s n.fq.gz ]]
+ [[ -n '' ]]

+ test -z cpn.fq
+ test -z 4C-pse_1.fastq

+ [[ ! -s o/long_total_length.txt ]]
+ seqkit stats -Ta cpn.fq
+ csvtk cut -t -f sum_len
+ csvtk del-header
++ cat o/long_total_length.txt
+ LONG_TOTAL_LENGTH=2092086846
+ echo 'DATA: long reads total (bases): 2092086846'
+ [[ ! -s o/19mer_out.histo ]]
++ file -b --mime-type 4C-pse_1.fastq
+ [[ inode/symlink == \a\p\p\l\i\c\a\t\i\o\n\/\g\z\i\p ]]
++ file -b --mime-type 4C-pse_2.fastq
+ [[ inode/symlink == \a\p\p\l\i\c\a\t\i\o\n\/\g\z\i\p ]]
+ jellyfish count -t 28 -C -m 19 -s 5G -o o/19mer_out '--min-qual-char=?' 4C-pse_1.fastq 4C-pse_2.fastq
+ jellyfish histo -o o/19mer_out.histo o/19mer_out
+ /home/goshng/all/polap/proj/src/run-polap-jellyfish.R o/19mer_out.histo 2092086846 o/long_coverage.txt o/short_expected_genome_size.txt
++ cat o/short_expected_genome_size.txt
+ EXPECTED_GENOME_SIZE=98175860.6
+ EXPECTED_GENOME_SIZE=98175860
++ cat o/long_coverage.txt
+ EXPECTED_COVERAGE=21.3095849958865
+ EXPECTED_COVERAGE=21
+ echo 'DATA: short reads expected genome size (bases): 98175860'
+ echo 'DATA: long reads expected coverage: 21x'
+ '[' 21 -lt 30 ']'
+ echo 'INFO: No reduction of the long-read data'


+ echo 'DEBUG: end of step0'


+ test 0 -eq 1
+ test 1 -eq 1
+ step1
+ echo 'DEBUG: start of step1'
+ command -v seqkit
+ command -v flye
+ test -z cpn.fq
+ test -z ''
+ LR3K=n3k.fq.gz
+ [[ -s cpn.fq ]]
+ seqkit seq --quiet -m 3000 --threads 4 cpn.fq -o n3k.fq.gz
+ echo 'DATA: long-read minimum 3kb reads data n3k.fq.gz is created'
+ [[ -s o/assembly_info.txt ]]
+ [[ --contigger == \-\-\c\o\n\t\i\g\g\e\r ]]
+ [[ -s o/30-contigger/graph_final.gfa ]]
+ [[ -s o/short_expected_genome_size.txt ]]
+ [[ o == \o ]]
+ echo 'DEBUG: o == o'
++ cat o/short_expected_genome_size.txt
+ EXPECTED_GENOME_SIZE=98175860.6
+ EXPECTED_GENOME_SIZE=98175860
+ echo 'Step 1: flye whole-genome assembly on the folder: o'
+ '[' -z ']'
+ [[ --contigger == \-\-\c\o\n\t\i\g\g\e\r ]]
+ flye --nano-raw n3k.fq.gz --out-dir o --threads 28 --stop-after contigger --asm-coverage 30 --genome-size 98175860
+ [[ 0 -eq 0 ]]
+ astep1
+ cat
After step1:
excucte R, then type in the following two lines.
library(dplyr)
+ [[ -s o/assembly_info.txt ]]
+ echoerr 'x = as_tibble(read.table("o/30-contigger/contigs_stats.txt"))'
+ echo 'x = as_tibble(read.table("o/30-contigger/contigs_stats.txt"))'
x = as_tibble(read.table("o/30-contigger/contigs_stats.txt"))
+ [[ -s o/assembly_info.txt ]]
++ realpath o/30-contigger/graph_final.gfa
+ echoall 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
+ echo 'DEBUG: end of step1'


+ step2
+ echo 'DEBUG: start of step2'
+ command -v seqkit
+ command -v makeblastdb
+ command -v tblastn
+ command -v bedtools
+ echo Step 2: organelle gene annotation ...
+ [[ -s o/assembly_info.txt ]]
+ FLYE_CONTIGGER=--contigger
+ /home/goshng/all/polap/proj/src/run-polap-annotation o 2 --selective-annotate --contigger
+ '[' 0 -ne 0 ']'
+ [[ 0 -eq 0 ]]
+ astep2
+ cat
Step2: run R and
out="o"
source("/home/goshng/all/polap/proj/src/run-polap-sum.R")
then type in z, z.1, z.v
z %>% arrange(V6) :for annotated contigs by multiplicity order
z %>% arrange(mt<pt) :for annotated contigs by mt/pt gene counts
z.1 %>% arrange(V6) %>% print(n=1000) :for all contigs
For Step3: to check mt or pt genes in the contigs.
run:
polap -3
to find the number for the next step 4.
Use the following code to create a contig name file for step 4
  V6 is copy number, and V3 is the length of a contig
Play with filter to select contigs you want to continue with step 4
replace the number at the end of the output file or mt.contig-name-1
  with the number you get from polap -3 command
z %>% filter(V6<3000,V6>2,V2>1000) %>% select(V1) %>% write.table("o/50-annotation/mt.contig.name-1",row.names=F,col.names=F,quote=F)
+ [[ -s o/assembly_info.txt ]]
++ realpath o/30-contigger/graph_final.gfa
+ echoall 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/30-contigger/graph_final.gfa'
+ echo 'DEBUG: end of step2'


+ echo 'DEBUG: start of step3'
+ [[ 0 -eq 0 ]]
+ bstep4
+ echoerr 'Before Step 4:'
+ echo 'Before Step 4:'
Before Step 4:
+ for i in {1..9}
+ test -s o/50-annotation/mt.contig.name-1
+ cat
Next 60-mt trial number is 1
Execute R:
out="o"
source("/home/goshng/all/polap/proj/src/run-polap-sum.R")
z %>% select(V1) %>% write.table("o/50-annotation/mt.contig.name-1",row.names=F,col.names=F,quote=F)
Then execute:
polap -4 1 -o o -k <n3k-longread fastq>
+ break
+ FLYEDIR=o
+ CONTIGNAME=o/50-annotation/mt.contig.name
+ LOG=o/assembly_info_organelle_annotation_count.txt
+ echo 'Step 3: mtDNA contig candidates selection'
+ [[ -s o/assembly_info.txt ]]
+ FLYE_CONTIGGER=--contigger
+ /home/goshng/all/polap/proj/src/run-polap-mtcontig.R o o/50-annotation/mt.contig.name o/assembly_info_organelle_annotation_count.txt --contigger
+ echoall 'INFO: o/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echo 'INFO: o/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
INFO: o/50-annotation/mt.contig.name-1 for mtDNA contig candidates
+ echo 'INFO: o/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echoall 'INFO: o/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echo 'INFO: o/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
INFO: o/50-annotation/mt.contig.name-2 for ptDNA contig candidates
+ echo 'INFO: o/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echoall 'INFO: annotation: column -t o/assembly_info_organelle_annotation_count.txt'
+ echo 'INFO: annotation: column -t o/assembly_info_organelle_annotation_count.txt'
INFO: annotation: column -t o/assembly_info_organelle_annotation_count.txt
+ echo 'INFO: annotation: column -t o/assembly_info_organelle_annotation_count.txt'
+ echo 'DEBUG: end of step3'



+ echo 'DEBUG: start of step4'
+ [[ 0 -eq 0 ]]
+ version_print
++ basename /home/goshng/all/polap/proj/src/polap
+ echo 'polap version 0.1.4'
+ MULTISTEP=1
+ command -v seqkit
+ command -v minimap2
+ command -v csvtk
+ ADIR=o/50-annotation
+ MTDIR=o/60-mt-1
+ test -z ''
+ LR3K=n3k.fq.gz
+ [[ ! -s n3k.fq.gz ]]
++ cut -d_ -f 1 o/50-annotation/mt.contig.name-1
++ sort
++ uniq
+ x=contig
+ [[ contig == \e\d\g\e ]]
+ [[ contig == \c\o\n\t\i\g ]]
+ echo 'INFO: mt.contig.name-1: contig only'
+ echo 'WARNING: --use-edges option is turned off'
+ USE_EDGES=--no-use-edges
+ [[ --no-use-edges == \-\-\u\s\e\-\e\d\g\e\s ]]
+ [[ -s o/assembly_info.txt ]]
+ ASSEMBLY_FASTA=o/30-contigger/contigs.fasta
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-1'
+ [[ 0 -eq 0 ]]
+ MTODIR=o/60-mt-1/o3000
+ MTSEEDSDIR=o/60-mt-1/o3000/seeds
+ echoall 'INFO: step4run on o/60-mt-1/o3000/seeds'
+ echo 'INFO: step4run on o/60-mt-1/o3000/seeds'
INFO: step4run on o/60-mt-1/o3000/seeds
+ echo 'INFO: step4run on o/60-mt-1/o3000/seeds'
+ step4run
+ echo 'DEBUG: start of step4run'
+ rm -rf o/60-mt-1/o3000
+ mkdir -p o/60-mt-1/o3000/seeds
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-1/o3000'
+ [[ ! -s o/60-mt-1/contig.tab ]]
+ echo 'INFO: organelle contigs selection'
+ [[ -s o/50-annotation/mt.contig-1.fa ]]
+ seqkit grep -f o/50-annotation/mt.contig.name-1 o/30-contigger/contigs.fasta -o o/60-mt-1/contig.fa
+ echo 'DATA: n3k.fq.gz is used to select reads'
+ [[ ! -s o/60-mt-1/contig.paf ]]
+ minimap2 -cx map-ont o/60-mt-1/contig.fa n3k.fq.gz -t 28 -o o/60-mt-1/contig.paf
+ echo 'DATA: mininmum length of long reads in the selection mapping: 3000'
+ cut -f1-11 o/60-mt-1/contig.paf
+ awk -v minlength=3000 '{if ($2>=minlength) {print}}'
++ seqkit stats -Ta o/60-mt-1/contig.fa
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ CONTIG_LENGTH=1263302
+ [[ ! -s o/60-mt-1/o3000/seeds/1.fq.gz ]]
+ echo 'INFO: organelle read selection min length: 3000 bp'
++ wc -l
+ contig_count=11
+ '[' 11 -gt 1 ']'
+ /home/goshng/all/polap/proj/src/run-polap-pairs.R o/50-annotation/mt.contig.name-1 o/60-mt-1/contig.tab o/60-mt-1/o3000/seeds 3000 3000
+ echo 'INFO: begin - cat names and the single name'
+ sort
+ cat o/60-mt-1/o3000/seeds/2043_2044.name o/60-mt-1/o3000/seeds/2043_2841.name o/60-mt-1/o3000/seeds/2043_2848.name o/60-mt-1/o3000/seeds/2043_2849.name o/60-mt-1/o3000/seeds/2043_336.name o/60-mt-1/o3000/seeds/2043_337.name o/60-mt-1/o3000/seeds/2043_420.name o/60-mt-1/o3000/seeds/2043_421.name o/60-mt-1/o3000/seeds/2043_422.name o/60-mt-1/o3000/seeds/2043_698.name o/60-mt-1/o3000/seeds/2044_2849.name o/60-mt-1/o3000/seeds/2044_336.name o/60-mt-1/o3000/seeds/2044_337.name o/60-mt-1/o3000/seeds/2044_698.name o/60-mt-1/o3000/seeds/2841_2044.name o/60-mt-1/o3000/seeds/2841_2848.name o/60-mt-1/o3000/seeds/2841_2849.name o/60-mt-1/o3000/seeds/2841_336.name o/60-mt-1/o3000/seeds/2841_337.name o/60-mt-1/o3000/seeds/2841_420.name o/60-mt-1/o3000/seeds/2841_698.name o/60-mt-1/o3000/seeds/2848_2044.name o/60-mt-1/o3000/seeds/2848_2849.name o/60-mt-1/o3000/seeds/2848_336.name o/60-mt-1/o3000/seeds/2848_337.name o/60-mt-1/o3000/seeds/2848_698.name o/60-mt-1/o3000/seeds/2849_336.name o/60-mt-1/o3000/seeds/337_2849.name o/60-mt-1/o3000/seeds/337_336.name o/60-mt-1/o3000/seeds/420_2044.name o/60-mt-1/o3000/seeds/420_2848.name o/60-mt-1/o3000/seeds/420_2849.name o/60-mt-1/o3000/seeds/420_336.name o/60-mt-1/o3000/seeds/420_337.name o/60-mt-1/o3000/seeds/420_698.name o/60-mt-1/o3000/seeds/421_2044.name o/60-mt-1/o3000/seeds/421_2841.name o/60-mt-1/o3000/seeds/421_2848.name o/60-mt-1/o3000/seeds/421_2849.name o/60-mt-1/o3000/seeds/421_336.name o/60-mt-1/o3000/seeds/421_337.name o/60-mt-1/o3000/seeds/421_420.name o/60-mt-1/o3000/seeds/421_422.name o/60-mt-1/o3000/seeds/421_698.name o/60-mt-1/o3000/seeds/422_2044.name o/60-mt-1/o3000/seeds/422_2841.name o/60-mt-1/o3000/seeds/422_2848.name o/60-mt-1/o3000/seeds/422_2849.name o/60-mt-1/o3000/seeds/422_336.name o/60-mt-1/o3000/seeds/422_337.name o/60-mt-1/o3000/seeds/422_420.name o/60-mt-1/o3000/seeds/422_698.name o/60-mt-1/o3000/seeds/698_2849.name o/60-mt-1/o3000/seeds/698_336.name o/60-mt-1/o3000/seeds/698_337.name o/60-mt-1/o3000/seeds/single.names
+ uniq
+ echo 'INFO: end - cat names and the single name'
+ seqkit grep -f o/60-mt-1/o3000/seeds/1.names n3k.fq.gz -o o/60-mt-1/o3000/seeds/1.fq.gz
+ echo 'DATA: organelle reads in o/60-mt-1/o3000/seeds/1.fq.gz'
++ seqkit stats -Ta o/60-mt-1/o3000/seeds/1.fq.gz
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ TOTAL_LENGTH=20613568
+ EXPECTED_COVERAGE=16
+ echo 'INFO: organelle genome size based on contig selection: 1263302'
+ echo 'INFO: expected coverage: 16 x'
+ [[ -z '' ]]
+ '[' 16 -lt 100 ']'
+ echo 'DATA: no data reduction: COV=100'
+ ln -s 1.fq.gz o/60-mt-1/o3000/seeds/2.fq.gz
+ '[' -z ']'
+ flye --nano-raw o/60-mt-1/o3000/seeds/2.fq.gz --out-dir o/60-mt-1/o3000 --asm-coverage 30 --genome-size 1263302 --threads 28
+ ODIR=o/60-mt-1/o3000
+ [[ -s o/60-mt-1/o3000/assembly_info.txt ]]
++ realpath o/60-mt-1/o3000/assembly_graph.gfa
+ echoall 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-1/o3000/assembly_graph.gfa'
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-1/o3000/assembly_graph.gfa'
INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-1/o3000/assembly_graph.gfa
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-1/o3000/assembly_graph.gfa'
+ ALL_ANNOTATE=--all-annotate
+ step2
+ echo 'DEBUG: start of step2'
+ command -v seqkit
+ command -v makeblastdb
+ command -v tblastn
+ command -v bedtools
+ echo Step 2: organelle gene annotation ...
+ [[ -s o/60-mt-1/o3000/assembly_info.txt ]]
+ /home/goshng/all/polap/proj/src/run-polap-annotation o/60-mt-1/o3000 28 --all-annotate
+ '[' 0 -ne 0 ']'
+ [[ 1 -eq 0 ]]
+ echo 'DEBUG: end of step2'
+ step3
+ echo 'DEBUG: start of step3'
+ [[ 1 -eq 0 ]]
+ FLYEDIR=o/60-mt-1/o3000
+ CONTIGNAME=o/60-mt-1/o3000/50-annotation/mt.contig.name
+ LOG=o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'Step 3: mtDNA contig candidates selection'
+ [[ -s o/60-mt-1/o3000/assembly_info.txt ]]
+ FLYE_CONTIGGER=--polishing
+ /home/goshng/all/polap/proj/src/run-polap-mtcontig.R o/60-mt-1/o3000 o/60-mt-1/o3000/50-annotation/mt.contig.name o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt --polishing
+ echoall 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echo 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates
+ echo 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echoall 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echo 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates
+ echo 'INFO: o/60-mt-1/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echoall 'INFO: annotation: column -t o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'INFO: annotation: column -t o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt'
INFO: annotation: column -t o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'INFO: annotation: column -t o/60-mt-1/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'DEBUG: end of step3'
+ echo 'DEBUG: end of step4'
+ STEP4=0
+ echo 'DEBUG: end of step4'

(polap-dev) goshng@thorne:/media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna$ polap -4 2 -t 28 --use-edges
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 2 -gt 0
+ step4
+ echo 'DEBUG: start of step4'
+ [[ 0 -eq 0 ]]
+ version_print
++ basename /home/goshng/all/polap/proj/src/polap
+ echo 'polap version 0.1.4'
+ MULTISTEP=1
+ command -v seqkit
+ command -v minimap2
+ command -v csvtk
+ ADIR=o/50-annotation
+ MTDIR=o/60-mt-2
+ test -z ''
+ LR3K=n3k.fq.gz
+ [[ ! -s n3k.fq.gz ]]
++ cut -d_ -f 1 o/50-annotation/mt.contig.name-2
++ sort
++ uniq
+ x=edge
+ [[ edge == \e\d\g\e ]]
+ echo 'INFO: mt.contig.name-2: edge only'
+ echo 'WARNING: --use-edges option is turned on'
+ USE_EDGES=--use-edges
+ [[ --use-edges == \-\-\u\s\e\-\e\d\g\e\s ]]
+ [[ -s o/assembly_info.txt ]]
+ ASSEMBLY_FASTA=o/30-contigger/graph_final.fasta
+ echo 'INFO: use edges not contigs: o/30-contigger/graph_final.fasta'
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-2'
+ [[ 0 -eq 0 ]]
+ MTODIR=o/60-mt-2/o3000
+ MTSEEDSDIR=o/60-mt-2/o3000/seeds
+ echoall 'INFO: step4run on o/60-mt-2/o3000/seeds'
+ echo 'INFO: step4run on o/60-mt-2/o3000/seeds'
INFO: step4run on o/60-mt-2/o3000/seeds
+ echo 'INFO: step4run on o/60-mt-2/o3000/seeds'
+ step4run
+ echo 'DEBUG: start of step4run'
+ rm -rf o/60-mt-2/o3000
+ mkdir -p o/60-mt-2/o3000/seeds
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-2/o3000'
+ [[ ! -s o/60-mt-2/contig.tab ]]
+ echo 'INFO: organelle contigs selection'
+ [[ -s o/50-annotation/mt.contig-2.fa ]]
+ seqkit grep -f o/50-annotation/mt.contig.name-2 o/30-contigger/graph_final.fasta -o o/60-mt-2/contig.fa
+ echo 'DATA: n3k.fq.gz is used to select reads'
+ [[ ! -s o/60-mt-2/contig.paf ]]
+ minimap2 -cx map-ont o/60-mt-2/contig.fa n3k.fq.gz -t 28 -o o/60-mt-2/contig.paf
+ echo 'DATA: mininmum length of long reads in the selection mapping: 3000'
+ cut -f1-11 o/60-mt-2/contig.paf
+ awk -v minlength=3000 '{if ($2>=minlength) {print}}'
++ seqkit stats -Ta o/60-mt-2/contig.fa
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ CONTIG_LENGTH=962037
+ [[ ! -s o/60-mt-2/o3000/seeds/1.fq.gz ]]
+ echo 'INFO: organelle read selection min length: 3000 bp'
++ wc -l
+ contig_count=9
+ '[' 9 -gt 1 ']'
+ /home/goshng/all/polap/proj/src/run-polap-pairs.R o/50-annotation/mt.contig.name-2 o/60-mt-2/contig.tab o/60-mt-2/o3000/seeds 3000 3000
+ echo 'INFO: begin - cat names and the single name'
+ sort
+ uniq
+ cat o/60-mt-2/o3000/seeds/2042_2043.name o/60-mt-2/o3000/seeds/2042_2044.name o/60-mt-2/o3000/seeds/2042_2847.name o/60-mt-2/o3000/seeds/2042_2848.name o/60-mt-2/o3000/seeds/2042_2849.name o/60-mt-2/o3000/seeds/2042_420.name o/60-mt-2/o3000/seeds/2042_421.name o/60-mt-2/o3000/seeds/2042_422.name o/60-mt-2/o3000/seeds/2043_2044.name o/60-mt-2/o3000/seeds/2043_2847.name o/60-mt-2/o3000/seeds/2043_2848.name o/60-mt-2/o3000/seeds/2043_2849.name o/60-mt-2/o3000/seeds/2043_420.name o/60-mt-2/o3000/seeds/2043_421.name o/60-mt-2/o3000/seeds/2043_422.name o/60-mt-2/o3000/seeds/2044_2847.name o/60-mt-2/o3000/seeds/2044_2848.name o/60-mt-2/o3000/seeds/2044_2849.name o/60-mt-2/o3000/seeds/2044_420.name o/60-mt-2/o3000/seeds/2044_421.name o/60-mt-2/o3000/seeds/2044_422.name o/60-mt-2/o3000/seeds/2847_2848.name o/60-mt-2/o3000/seeds/2847_2849.name o/60-mt-2/o3000/seeds/2847_420.name o/60-mt-2/o3000/seeds/2847_421.name o/60-mt-2/o3000/seeds/2847_422.name o/60-mt-2/o3000/seeds/2848_2849.name o/60-mt-2/o3000/seeds/2848_420.name o/60-mt-2/o3000/seeds/2848_421.name o/60-mt-2/o3000/seeds/2848_422.name o/60-mt-2/o3000/seeds/2849_420.name o/60-mt-2/o3000/seeds/2849_421.name o/60-mt-2/o3000/seeds/2849_422.name o/60-mt-2/o3000/seeds/420_421.name o/60-mt-2/o3000/seeds/420_422.name o/60-mt-2/o3000/seeds/421_422.name o/60-mt-2/o3000/seeds/single.names
+ echo 'INFO: end - cat names and the single name'
+ seqkit grep -f o/60-mt-2/o3000/seeds/1.names n3k.fq.gz -o o/60-mt-2/o3000/seeds/1.fq.gz
+ echo 'DATA: organelle reads in o/60-mt-2/o3000/seeds/1.fq.gz'
++ seqkit stats -Ta o/60-mt-2/o3000/seeds/1.fq.gz
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ TOTAL_LENGTH=11003839
+ EXPECTED_COVERAGE=11
+ echo 'INFO: organelle genome size based on contig selection: 962037'
+ echo 'INFO: expected coverage: 11 x'
+ [[ -z '' ]]
+ '[' 11 -lt 100 ']'
+ echo 'DATA: no data reduction: COV=100'
+ ln -s 1.fq.gz o/60-mt-2/o3000/seeds/2.fq.gz
+ '[' -z ']'
+ flye --nano-raw o/60-mt-2/o3000/seeds/2.fq.gz --out-dir o/60-mt-2/o3000 --asm-coverage 30 --genome-size 962037 --threads 28
+ ODIR=o/60-mt-2/o3000
+ [[ -s o/60-mt-2/o3000/assembly_info.txt ]]
++ realpath o/60-mt-2/o3000/assembly_graph.gfa
+ echoall 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-2/o3000/assembly_graph.gfa'
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-2/o3000/assembly_graph.gfa'
INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-2/o3000/assembly_graph.gfa
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-2/o3000/assembly_graph.gfa'
+ ALL_ANNOTATE=--all-annotate
+ step2
+ echo 'DEBUG: start of step2'
+ command -v seqkit
+ command -v makeblastdb
+ command -v tblastn
+ command -v bedtools
+ echo Step 2: organelle gene annotation ...
+ [[ -s o/60-mt-2/o3000/assembly_info.txt ]]
+ /home/goshng/all/polap/proj/src/run-polap-annotation o/60-mt-2/o3000 28 --all-annotate
+ '[' 0 -ne 0 ']'
+ [[ 1 -eq 0 ]]
+ echo 'DEBUG: end of step2'
+ step3
+ echo 'DEBUG: start of step3'
+ [[ 1 -eq 0 ]]
+ FLYEDIR=o/60-mt-2/o3000
+ CONTIGNAME=o/60-mt-2/o3000/50-annotation/mt.contig.name
+ LOG=o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'Step 3: mtDNA contig candidates selection'
+ [[ -s o/60-mt-2/o3000/assembly_info.txt ]]
+ FLYE_CONTIGGER=--polishing
+ /home/goshng/all/polap/proj/src/run-polap-mtcontig.R o/60-mt-2/o3000 o/60-mt-2/o3000/50-annotation/mt.contig.name o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt --polishing
+ echoall 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echo 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates
+ echo 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echoall 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echo 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates
+ echo 'INFO: o/60-mt-2/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echoall 'INFO: annotation: column -t o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'INFO: annotation: column -t o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt'
INFO: annotation: column -t o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'INFO: annotation: column -t o/60-mt-2/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'DEBUG: end of step3'
+ echo 'DEBUG: end of step4'
+ STEP4=0
+ echo 'DEBUG: end of step4'



(polap-dev) goshng@thorne:/media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna$ polap -4 3 -t 28 --use-edges
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 3 -gt 0
+ step4
+ echo 'DEBUG: start of step4'
+ [[ 0 -eq 0 ]]
+ version_print
++ basename /home/goshng/all/polap/proj/src/polap
+ echo 'polap version 0.1.4'
+ MULTISTEP=1
+ command -v seqkit
+ command -v minimap2
+ command -v csvtk
+ ADIR=o/50-annotation
+ MTDIR=o/60-mt-3
+ test -z ''
+ LR3K=n3k.fq.gz
+ [[ ! -s n3k.fq.gz ]]
++ cut -d_ -f 1 o/50-annotation/mt.contig.name-3
++ sort
++ uniq
+ x=edge
+ [[ edge == \e\d\g\e ]]
+ echo 'INFO: mt.contig.name-3: edge only'
+ echo 'WARNING: --use-edges option is turned on'
+ USE_EDGES=--use-edges
+ [[ --use-edges == \-\-\u\s\e\-\e\d\g\e\s ]]
+ [[ -s o/assembly_info.txt ]]
+ ASSEMBLY_FASTA=o/30-contigger/graph_final.fasta
+ echo 'INFO: use edges not contigs: o/30-contigger/graph_final.fasta'
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-3'
+ [[ 0 -eq 0 ]]
+ MTODIR=o/60-mt-3/o3000
+ MTSEEDSDIR=o/60-mt-3/o3000/seeds
+ echoall 'INFO: step4run on o/60-mt-3/o3000/seeds'
+ echo 'INFO: step4run on o/60-mt-3/o3000/seeds'
INFO: step4run on o/60-mt-3/o3000/seeds
+ echo 'INFO: step4run on o/60-mt-3/o3000/seeds'
+ step4run
+ echo 'DEBUG: start of step4run'
+ rm -rf o/60-mt-3/o3000
+ mkdir -p o/60-mt-3/o3000/seeds
+ echo 'Step 4: flye organelle genome assembly on the folder: o/60-mt-3/o3000'
+ [[ ! -s o/60-mt-3/contig.tab ]]
+ echo 'INFO: organelle contigs selection'
+ [[ -s o/50-annotation/mt.contig-3.fa ]]
+ seqkit grep -f o/50-annotation/mt.contig.name-3 o/30-contigger/graph_final.fasta -o o/60-mt-3/contig.fa
+ echo 'DATA: n3k.fq.gz is used to select reads'
+ [[ ! -s o/60-mt-3/contig.paf ]]
+ minimap2 -cx map-ont o/60-mt-3/contig.fa n3k.fq.gz -t 28 -o o/60-mt-3/contig.paf
+ echo 'DATA: mininmum length of long reads in the selection mapping: 3000'
+ cut -f1-11 o/60-mt-3/contig.paf
+ awk -v minlength=3000 '{if ($2>=minlength) {print}}'
++ seqkit stats -Ta o/60-mt-3/contig.fa
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ CONTIG_LENGTH=1351850
+ [[ ! -s o/60-mt-3/o3000/seeds/1.fq.gz ]]
+ echo 'INFO: organelle read selection min length: 3000 bp'
++ wc -l
+ contig_count=12
+ '[' 12 -gt 1 ']'
+ /home/goshng/all/polap/proj/src/run-polap-pairs.R o/50-annotation/mt.contig.name-3 o/60-mt-3/contig.tab o/60-mt-3/o3000/seeds 3000 3000
+ echo 'INFO: begin - cat names and the single name'
+ sort
+ uniq
+ cat o/60-mt-3/o3000/seeds/1242_2815.name o/60-mt-3/o3000/seeds/2042_1242.name o/60-mt-3/o3000/seeds/2042_2043.name o/60-mt-3/o3000/seeds/2042_2044.name o/60-mt-3/o3000/seeds/2042_208.name o/60-mt-3/o3000/seeds/2042_2815.name o/60-mt-3/o3000/seeds/2042_2847.name o/60-mt-3/o3000/seeds/2042_2848.name o/60-mt-3/o3000/seeds/2042_2849.name o/60-mt-3/o3000/seeds/2042_420.name o/60-mt-3/o3000/seeds/2042_421.name o/60-mt-3/o3000/seeds/2042_422.name o/60-mt-3/o3000/seeds/2043_1242.name o/60-mt-3/o3000/seeds/2043_2044.name o/60-mt-3/o3000/seeds/2043_208.name o/60-mt-3/o3000/seeds/2043_2815.name o/60-mt-3/o3000/seeds/2043_2847.name o/60-mt-3/o3000/seeds/2043_2848.name o/60-mt-3/o3000/seeds/2043_2849.name o/60-mt-3/o3000/seeds/2043_420.name o/60-mt-3/o3000/seeds/2043_421.name o/60-mt-3/o3000/seeds/2043_422.name o/60-mt-3/o3000/seeds/2044_1242.name o/60-mt-3/o3000/seeds/2044_208.name o/60-mt-3/o3000/seeds/2044_2815.name o/60-mt-3/o3000/seeds/2044_2847.name o/60-mt-3/o3000/seeds/2044_2848.name o/60-mt-3/o3000/seeds/2044_2849.name o/60-mt-3/o3000/seeds/2044_420.name o/60-mt-3/o3000/seeds/2044_421.name o/60-mt-3/o3000/seeds/2044_422.name o/60-mt-3/o3000/seeds/208_1242.name o/60-mt-3/o3000/seeds/208_2815.name o/60-mt-3/o3000/seeds/2847_1242.name o/60-mt-3/o3000/seeds/2847_208.name o/60-mt-3/o3000/seeds/2847_2815.name o/60-mt-3/o3000/seeds/2847_2848.name o/60-mt-3/o3000/seeds/2847_2849.name o/60-mt-3/o3000/seeds/2847_420.name o/60-mt-3/o3000/seeds/2847_421.name o/60-mt-3/o3000/seeds/2847_422.name o/60-mt-3/o3000/seeds/2848_1242.name o/60-mt-3/o3000/seeds/2848_208.name o/60-mt-3/o3000/seeds/2848_2815.name o/60-mt-3/o3000/seeds/2848_2849.name o/60-mt-3/o3000/seeds/2848_420.name o/60-mt-3/o3000/seeds/2848_421.name o/60-mt-3/o3000/seeds/2848_422.name o/60-mt-3/o3000/seeds/2849_1242.name o/60-mt-3/o3000/seeds/2849_208.name o/60-mt-3/o3000/seeds/2849_2815.name o/60-mt-3/o3000/seeds/2849_420.name o/60-mt-3/o3000/seeds/2849_421.name o/60-mt-3/o3000/seeds/2849_422.name o/60-mt-3/o3000/seeds/420_1242.name o/60-mt-3/o3000/seeds/420_208.name o/60-mt-3/o3000/seeds/420_2815.name o/60-mt-3/o3000/seeds/420_421.name o/60-mt-3/o3000/seeds/420_422.name o/60-mt-3/o3000/seeds/421_1242.name o/60-mt-3/o3000/seeds/421_208.name o/60-mt-3/o3000/seeds/421_2815.name o/60-mt-3/o3000/seeds/421_422.name o/60-mt-3/o3000/seeds/422_1242.name o/60-mt-3/o3000/seeds/422_208.name o/60-mt-3/o3000/seeds/422_2815.name o/60-mt-3/o3000/seeds/single.names
+ echo 'INFO: end - cat names and the single name'
+ seqkit grep -f o/60-mt-3/o3000/seeds/1.names n3k.fq.gz -o o/60-mt-3/o3000/seeds/1.fq.gz
+ echo 'DATA: organelle reads in o/60-mt-3/o3000/seeds/1.fq.gz'
++ seqkit stats -Ta o/60-mt-3/o3000/seeds/1.fq.gz
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ TOTAL_LENGTH=13322086
+ EXPECTED_COVERAGE=9
+ echo 'INFO: organelle genome size based on contig selection: 1351850'
+ echo 'INFO: expected coverage: 9 x'
+ [[ -z '' ]]
+ '[' 9 -lt 100 ']'
+ echo 'DATA: no data reduction: COV=100'
+ ln -s 1.fq.gz o/60-mt-3/o3000/seeds/2.fq.gz
+ '[' -z ']'
+ flye --nano-raw o/60-mt-3/o3000/seeds/2.fq.gz --out-dir o/60-mt-3/o3000 --asm-coverage 30 --genome-size 1351850 --threads 28
+ ODIR=o/60-mt-3/o3000
+ [[ -s o/60-mt-3/o3000/assembly_info.txt ]]
++ realpath o/60-mt-3/o3000/assembly_graph.gfa
+ echoall 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-3/o3000/assembly_graph.gfa'
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-3/o3000/assembly_graph.gfa'
INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-3/o3000/assembly_graph.gfa
+ echo 'INFO: assembly graph: /media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna/o/60-mt-3/o3000/assembly_graph.gfa'
+ ALL_ANNOTATE=--all-annotate
+ step2
+ echo 'DEBUG: start of step2'
+ command -v seqkit
+ command -v makeblastdb
+ command -v tblastn
+ command -v bedtools
+ echo Step 2: organelle gene annotation ...
+ [[ -s o/60-mt-3/o3000/assembly_info.txt ]]
+ /home/goshng/all/polap/proj/src/run-polap-annotation o/60-mt-3/o3000 28 --all-annotate
+ '[' 0 -ne 0 ']'
+ [[ 1 -eq 0 ]]
+ echo 'DEBUG: end of step2'
+ step3
+ echo 'DEBUG: start of step3'
+ [[ 1 -eq 0 ]]
+ FLYEDIR=o/60-mt-3/o3000
+ CONTIGNAME=o/60-mt-3/o3000/50-annotation/mt.contig.name
+ LOG=o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'Step 3: mtDNA contig candidates selection'
+ [[ -s o/60-mt-3/o3000/assembly_info.txt ]]
+ FLYE_CONTIGGER=--polishing
+ /home/goshng/all/polap/proj/src/run-polap-mtcontig.R o/60-mt-3/o3000 o/60-mt-3/o3000/50-annotation/mt.contig.name o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt --polishing
+ echoall 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echo 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates
+ echo 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-1 for mtDNA contig candidates'
+ echoall 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echo 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates
+ echo 'INFO: o/60-mt-3/o3000/50-annotation/mt.contig.name-2 for ptDNA contig candidates'
+ echoall 'INFO: annotation: column -t o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'INFO: annotation: column -t o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt'
INFO: annotation: column -t o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt
+ echo 'INFO: annotation: column -t o/60-mt-3/o3000/assembly_info_organelle_annotation_count.txt'
+ echo 'DEBUG: end of step3'
+ echo 'DEBUG: end of step4'
+ STEP4=0
+ echo 'DEBUG: end of step4'




(polap-dev) goshng@thorne:/media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna$ polap -5 -f cpseudochinensis.mt.0.fasta
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -gt 0
+ test 1 -eq 1
+ step5
+ echo 'DEBUG: beginning of step5'
+ command -v minimap2
+ command -v samtools
+ test -z cpseudochinensis.mt.0.fasta
+ test -z ''
+ LR3K=n3k.fq.gz
+ echo 'DATA: n3k.fq.gz is used for coverage analysis'
+ [[ ! -s n3k.fq.gz ]]
+ echo INFO: long-reads assembled organelle genome in FASTA format: cpseudochinensis.mt.0.fasta
+ echo INFO: long-reads: n3k.fq.gz
+ echo INFO: number of cores: 2
+ minimap2 -t 2 -ax map-ont cpseudochinensis.mt.0.fasta n3k.fq.gz
+ samtools view -u
+ samtools sort -o 1.bam
[M::mm_idx_gen::0.047*1.01] collected minimizers
[M::mm_idx_gen::0.078*1.36] sorted minimizers
[M::main::0.078*1.36] loaded/built the index for 1 target sequence(s)
[M::mm_mapopt_update::0.083*1.34] mid_occ = 10
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.087*1.32] distinct minimizers: 178412 (95.99% are singletons); average occurrences: 1.045; average spacing: 5.345; total length: 996341
[M::worker_pipeline::17.255*2.04] mapped 38124 sequences
[M::worker_pipeline::39.080*2.00] mapped 37516 sequences
[M::worker_pipeline::51.962*1.91] mapped 36344 sequences
[M::worker_pipeline::64.377*1.55] mapped 27771 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -t 2 -ax map-ont cpseudochinensis.mt.0.fasta n3k.fq.gz
[M::main] Real time: 64.505 sec; CPU: 99.813 sec; Peak RSS: 2.039 GB
[bam_sort_core] merging from 3 files and 1 in-memory blocks...
+ samtools coverage -A -w 32 1.bam
+ echo 'DEBUG: end of step5'
+ echoerr INFO: execute: samtools coverage -A -w 32 1.bam
+ echo INFO: execute: samtools coverage -A -w 32 1.bam
INFO: execute: samtools coverage -A -w 32 1.bam
+ echoall Change your conda environment before performing STEP 6.
+ echo Change your conda environment before performing STEP 6.
Change your conda environment before performing STEP 6.
+ echo Change your conda environment before performing STEP 6.

conda activate polap-fmlrc


(polap-fmlrc) goshng@thorne:/media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna$ polap -6 -a 4C-pse_1.fastq -b 4C-pse_2.fastq
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -gt 0
+ test 0 -eq 1
+ test 1 -eq 1
+ step6
+ echo 'DEBUG: beginning of step6'
+ command -v msbwt
+ command -v ropebwt2
+ test -z 4C-pse_1.fastq
+ [[ 4C-pse_1.fastq = *.fastq ]]
+ cat 4C-pse_1.fastq 4C-pse_2.fastq
+ awk 'NR % 4 == 2'
+ sort
+ tr NT TN
+ ropebwt2 -LR
+ tr NT TN
+ msbwt convert o/msbwt
[M::main_ropebwt2] inserted 6369457709 symbols in 379.286 sec, 976.710 CPU sec
[M::main_ropebwt2] constructed FM-index in 639.918 sec, 999.039 CPU sec
[M::main_ropebwt2] symbol counts: ($, A, C, G, T, N) = (41956208, 2081341278, 1083881332, 1104689086, 24542, 2057565263)
[M::main] Version: r187
[M::main] CMD: ropebwt2 -LR
[M::main] Real time: 759.305 sec; CPU: 1117.402 sec
+ echo 'DEBUG: end of step6'


(polap-fmlrc) goshng@thorne:/media/h1/backup/gingko/data/Carex/Carex_pseudochinensis/mtdna$ polap -7 -p cpseudochinensis.mt.0.fasta -f cpseudochinensis.mt.1.fa
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -eq 1
+ test 0 -gt 0
+ test 0 -eq 1
+ test 0 -eq 1
+ test 1 -eq 1
+ step7
+ echo 'DEBUG: beginning of step7'
+ test -z cpseudochinensis.mt.0.fasta
+ test -z cpseudochinensis.mt.1.fa
+ [[ -s cpseudochinensis.mt.0.fasta ]]
+ fmlrc -p 2 o/msbwt/comp_msbwt.npy cpseudochinensis.mt.0.fasta cpseudochinensis.mt.1.fa
+ echo 'DEBUG: end of step7'
+ set +x


GeSeq step
- Poales and manual search for Jucus family
- Ignore genes annotated as ORFs
Geneious load geseq Genbank file
- export annotation to csv
- create a Number file
GeSeq gff3 file edit
- delete source
- replace 1 with 0
Delete features
- orf with small identity 
- fragments
Trans-splicing genes
- not done
Protein product
- not done
+ IFS=
+ read -r contig
+ grep -w contig_2905 o/50-annotation/ptaa.blast.sorted.bed
+ bedtools merge -i o/50-annotation/ptaa.bed/contig_2905.bed
++ wc -l
+ printf '%s\t%d\n' contig_2905 0
+ IFS=
+ read -r contig


+ src/run-polap-annotation o 28 --selective-annotate --contigger
+ '[' 4 -eq 0 ']'
+ WDIR=src
+ [[ ! -d src ]]
+ source src/run-polap-common.sh
+ MTAA=src/mt.1.c70.3.faa
+ PTAA=src/pt.2.c70.3.faa
+ [[ ! -f src/mt.1.c70.3.faa ]]
+ FLYEDIR=o
+ [[ -z 28 ]]
+ NUMTHREADS=28
+ [[ --selective-annotate == \-\-\a\l\l\-\a\n\n\o\t\a\t\e ]]
+ ALL_ANNOTATE=0
+ [[ --contigger == \-\-\c\o\n\t\i\g\g\e\r ]]
+ FLYE_CONTIGGER=1
+ [[ 1 -eq 0 ]]
+ ASSEMBLYINFO=o/30-contigger/contigs_stats.txt
+ ASSEMBLYFILE=o/30-contigger/contigs.fasta
+ ODIR=o/50-annotation
+ CONTIGFILE=o/50-annotation/contig.fasta
+ CONTIGDB=o/50-annotation/contig
+ MTAABLAST=o/50-annotation/mtaa.blast
+ MTAABED=o/50-annotation/mtaa.bed
+ MTGENECOUNT=o/50-annotation/mt.gene.count
+ PTAABLAST=o/50-annotation/ptaa.blast
+ PTAABED=o/50-annotation/ptaa.bed
+ PTGENECOUNT=o/50-annotation/pt.gene.count
+ mkdir -p o/50-annotation
+ echo 'INFO: o/50-annotation is created by src/run-polap-annotation'
INFO: o/50-annotation is created by src/run-polap-annotation
+ [[ -z '' ]]
+ CONTIGNAME=o/50-annotation/contig.name
+ [[ 0 -eq 0 ]]
+ [[ -s o/30-contigger/contigs_stats.txt ]]
+ src/run-polap-select.R o/30-contigger/contigs_stats.txt o/50-annotation/contig.name
+ '[' 0 -ne 0 ']'
+ seqkit grep -f o/50-annotation/contig.name o/30-contigger/contigs.fasta -o o/50-annotation/contig.fasta
+ makeblastdb -in o/50-annotation/contig.fasta -dbtype nucl -out o/50-annotation/contig
+ tblastn -query src/mt.1.c70.3.faa -db o/50-annotation/contig -out o/50-annotation/mtaa.blast -evalue 1e-30 -outfmt '6 qaccver saccver pident length mismatch gapopen qstart qend sstart send evalue bitscore stitle salltitles' -num_threads 28
+ [[ -n '' ]]
+ src/run-polap-genes.R o/50-annotation/mtaa.blast o/50-annotation/mtaa.blast.bed
+ sort -k1,1 -k2,2n o/50-annotation/mtaa.blast.bed
+ mkdir o/50-annotation/mtaa.bed
+ set +x
+ tar zcf o/50-annotation/mtaa.bed.tar.gz o/50-annotation/mtaa.bed
+ rm -rf o/50-annotation/mtaa.bed
+ tblastn -query src/pt.2.c70.3.faa -db o/50-annotation/contig -out o/50-annotation/ptaa.blast -evalue 1e-30 -outfmt '6 qaccver saccver pident length mismatch gapopen qstart qend sstart send evalue bitscore stitle salltitles' -num_threads 28
+ [[ -n '' ]]
+ src/run-polap-genes.R o/50-annotation/ptaa.blast o/50-annotation/ptaa.blast.bed
+ sort -k1,1 -k2,2n o/50-annotation/ptaa.blast.bed
+ mkdir o/50-annotation/ptaa.bed
+ set +x
+ tar zcf o/50-annotation/ptaa.bed.tar.gz o/50-annotation/ptaa.bed
+ rm -rf o/50-annotation/ptaa.bed













+ src/run-cp.sh
+ STEP4=3
+ ADIR=o/50-annotation
+ MTDIR=o/60-mt-3
+ MTODIR=o/60-mt-3/o3000
+ MTSEEDSDIR=o/60-mt-3/o3000/seeds
+ ASSEMBLY_FASTA=o/30-contigger/graph_final.fasta
+ SINGLE_MIN=3000
+ LR3K=n3k.fq.gz
+ rm -rf o/60-mt-3/o3000
+ mkdir -p o/60-mt-3/o3000/seeds
+ seqkit grep -f o/50-annotation/mt.contig.name-3 o/30-contigger/graph_final.fasta -o o/60-mt-3/contig.fa
+ echo 'DATA: o/60-mt-3/contig.fa is created.'
DATA: o/60-mt-3/contig.fa is created.
+ minimap2 -cx map-ont o/60-mt-3/contig.fa n3k.fq.gz -t 28 -o o/60-mt-3/contig.paf
+ echo 'DATA: n3k.fq.gz is used to select reads.'
DATA: n3k.fq.gz is used to select reads.
+ echo 'DATA: o/60-mt-3/contig.paf is created.'
DATA: o/60-mt-3/contig.paf is created.
+ cut -f1-11 o/60-mt-3/contig.paf
+ awk -v minlength= '{if ($2>=minlength) {print}}'
+ echo 'DATA: mininmum length of long reads in the selection mapping: 3000'
DATA: mininmum length of long reads in the selection mapping: 3000
+ echo 'DATA: o/60-mt-3/contig.tab is created.'
DATA: o/60-mt-3/contig.tab is created.
++ seqkit stats -Ta o/60-mt-3/contig.fa
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ CONTIG_LENGTH=1351850
+ echo 'INFO: organelle genome size based on contig selection: 1351850'
INFO: organelle genome size based on contig selection: 1351850
+ src/run-polap-pairs.R o/50-annotation/mt.contig.name-3 o/60-mt-3/contig.tab o/60-mt-3/o3000/seeds 3000 3000
+ echo 'DATA: pair contig names in o/60-mt-3/o3000/seeds are created.'
DATA: pair contig names in o/60-mt-3/o3000/seeds are created.
+ echo 'DATA: single contig name in o/60-mt-3/o3000/seeds is created.'
DATA: single contig name in o/60-mt-3/o3000/seeds is created.
+ sort
+ uniq
+ cat o/60-mt-3/o3000/seeds/1242_2815.name o/60-mt-3/o3000/seeds/2042_1242.name o/60-mt-3/o3000/seeds/2042_2043.name o/60-mt-3/o3000/seeds/2042_2044.name o/60-mt-3/o3000/seeds/2042_208.name o/60-mt-3/o3000/seeds/2042_2815.name o/60-mt-3/o3000/seeds/2042_2847.name o/60-mt-3/o3000/seeds/2042_2848.name o/60-mt-3/o3000/seeds/2042_2849.name o/60-mt-3/o3000/seeds/2042_420.name o/60-mt-3/o3000/seeds/2042_421.name o/60-mt-3/o3000/seeds/2042_422.name o/60-mt-3/o3000/seeds/2043_1242.name o/60-mt-3/o3000/seeds/2043_2044.name o/60-mt-3/o3000/seeds/2043_208.name o/60-mt-3/o3000/seeds/2043_2815.name o/60-mt-3/o3000/seeds/2043_2847.name o/60-mt-3/o3000/seeds/2043_2848.name o/60-mt-3/o3000/seeds/2043_2849.name o/60-mt-3/o3000/seeds/2043_420.name o/60-mt-3/o3000/seeds/2043_421.name o/60-mt-3/o3000/seeds/2043_422.name o/60-mt-3/o3000/seeds/2044_1242.name o/60-mt-3/o3000/seeds/2044_208.name o/60-mt-3/o3000/seeds/2044_2815.name o/60-mt-3/o3000/seeds/2044_2847.name o/60-mt-3/o3000/seeds/2044_2848.name o/60-mt-3/o3000/seeds/2044_2849.name o/60-mt-3/o3000/seeds/2044_420.name o/60-mt-3/o3000/seeds/2044_421.name o/60-mt-3/o3000/seeds/2044_422.name o/60-mt-3/o3000/seeds/208_1242.name o/60-mt-3/o3000/seeds/208_2815.name o/60-mt-3/o3000/seeds/2847_1242.name o/60-mt-3/o3000/seeds/2847_208.name o/60-mt-3/o3000/seeds/2847_2815.name o/60-mt-3/o3000/seeds/2847_2848.name o/60-mt-3/o3000/seeds/2847_2849.name o/60-mt-3/o3000/seeds/2847_420.name o/60-mt-3/o3000/seeds/2847_421.name o/60-mt-3/o3000/seeds/2847_422.name o/60-mt-3/o3000/seeds/2848_1242.name o/60-mt-3/o3000/seeds/2848_208.name o/60-mt-3/o3000/seeds/2848_2815.name o/60-mt-3/o3000/seeds/2848_2849.name o/60-mt-3/o3000/seeds/2848_420.name o/60-mt-3/o3000/seeds/2848_421.name o/60-mt-3/o3000/seeds/2848_422.name o/60-mt-3/o3000/seeds/2849_1242.name o/60-mt-3/o3000/seeds/2849_208.name o/60-mt-3/o3000/seeds/2849_2815.name o/60-mt-3/o3000/seeds/2849_420.name o/60-mt-3/o3000/seeds/2849_421.name o/60-mt-3/o3000/seeds/2849_422.name o/60-mt-3/o3000/seeds/420_1242.name o/60-mt-3/o3000/seeds/420_208.name o/60-mt-3/o3000/seeds/420_2815.name o/60-mt-3/o3000/seeds/420_421.name o/60-mt-3/o3000/seeds/420_422.name o/60-mt-3/o3000/seeds/421_1242.name o/60-mt-3/o3000/seeds/421_208.name o/60-mt-3/o3000/seeds/421_2815.name o/60-mt-3/o3000/seeds/421_422.name o/60-mt-3/o3000/seeds/422_1242.name o/60-mt-3/o3000/seeds/422_208.name o/60-mt-3/o3000/seeds/422_2815.name o/60-mt-3/o3000/seeds/single.names
+ echo 'INFO: creates long read names and the single name in o/60-mt-3/o3000/seeds/1.names'
INFO: creates long read names and the single name in o/60-mt-3/o3000/seeds/1.names
+ seqkit grep -f o/60-mt-3/o3000/seeds/1.names n3k.fq.gz -o o/60-mt-3/o3000/seeds/1.fq.gz
+ echo 'DATA: organelle reads in o/60-mt-3/o3000/seeds/1.fq.gz'
DATA: organelle reads in o/60-mt-3/o3000/seeds/1.fq.gz
++ seqkit stats -Ta o/60-mt-3/o3000/seeds/1.fq.gz
++ csvtk cut -t -f sum_len
++ csvtk del-header
+ TOTAL_LENGTH=13322086
+ EXPECTED_COVERAGE=9
+ echo 'INFO: expected coverage: 9x'
INFO: expected coverage: 9x
+ echo 'DATA: no data reduction: COV=100'
DATA: no data reduction: COV=100
+ ln -s 1.fq.gz o/60-mt-3/o3000/seeds/2.fq.gz
+ flye --nano-raw o/60-mt-3/o3000/seeds/2.fq.gz --out-dir o/60-mt-3/o3000 --asm-coverage 30 --genome-size 1351850 --threads 28

